package fetch

import (
	"os"
	"path/filepath"

	"github.com/spf13/cobra"
)

// FetchCmd represents the fetch command
var FetchCmd = &cobra.Command{
	Use:   "fetch",
	Short: "Fetch the data of exploit",
	Long:  `Fetch the data of exploit`,
}

func init() {
	// subcommands
	FetchCmd.AddCommand(fetchExploitDBCmd)
	FetchCmd.AddCommand(fetchAwesomePocCmd)
	FetchCmd.AddCommand(fetchGitHubReposCmd)

	// flags
	FetchCmd.PersistentFlags().Bool("debug-sql", false, "SQL debug mode")
	FetchCmd.PersistentFlags().String("dbpath", filepath.Join(os.Getenv("PWD"), "go-exploitdb.sqlite3"), "/path/to/sqlite3 or SQL connection string")
	FetchCmd.PersistentFlags().String("dbtype", "sqlite3", "Database type to store data in (sqlite3, mysql, postgres or redis supported)")
	FetchCmd.PersistentFlags().Int("batch-size", 500, "The number of batch size to insert.")
	FetchCmd.PersistentFlags().String("http-proxy", "", "http://proxy-url:port")
}
